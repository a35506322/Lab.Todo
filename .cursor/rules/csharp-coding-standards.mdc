---
globs: *.cs
alwaysApply: false
description: C# 編碼規範和最佳實踐
---

# C# 編碼規範和最佳實踐

## 命名規範

-   類別、方法、公開成員：PascalCase (例如：`IsUserSignedIn`, `CalculateTotal`)
-   局部變數、私有欄位：camelCase
-   常數：大寫字母 (例如：`MAX_RETRY_COUNT`)
-   介面：以 "I" 為前綴 (例如：`IUserService`)
-   使用描述性變數和方法名稱：例如：'IsUserSignedIn'、'CalculateTotal'

## C# 關鍵寫作規範

-   針對`更改的檔案`使用 `csharpier` 格式化程式碼 (如有語法錯誤請修正並告知)
-   使用 **GlobalUsing.cs** 進行全域 using 管理

```csharp
❌ BAD: 使用全域 using
using System;

✅ GOOD: 使用 GlobalUsing.cs 進行全域 using 管理
global using System;
```

-   使用 **primary constructor** 語法（C# 12）進行建構子注入

```csharp
❌ BAD: 使用傳統建構子注入
public class ExampleService
{
    private readonly ILogger<ExampleService> _logger;
    public ExampleService(ILogger<ExampleService> logger)
    {
        _logger = logger;
    }
}

✅ GOOD: 使用 primary constructor 語法（C# 12）進行建構子注入
public class ExampleService(ILogger<ExampleService> logger) { }
```

-   使用 pattern matching 取代 switch 語句，如：

```csharp
❌ BAD: 使用 switch 語句
switch (value)
{
    case int i:
        Console.WriteLine(i);
        break;
    case string s:
        Console.WriteLine(s);
        break;
}

✅ GOOD: 使用 pattern matching 取代 switch 語句
var result = value switch
{
    int i => i,
    string s => s,
    _ => throw new ArgumentException("Invalid value")
};
``
```

-   所有 class 都要有註解說明 (如：類別、方法、公開成員、局部變數、私有欄位、常數、介面)

```csharp
/// <summary>
/// 類別說明
/// </summary>
public class ExampleClass
{

    /// <summary>
    /// 公開成員說明
    /// </summary>
    public int ExampleProperty { get; set; }
}
```

-   函數使用 named arguments 傳遞參數

```csharp
/// <summary>
/// 函數說明
/// </summary>
/// <param name="parameter">參數說明</param>
/// <returns>回傳說明</returns>
public void ExampleFunction(int parameter)
{
}

✅ GOOD: 使用 named arguments 傳遞參數
ExampleFunction(parameter: 1);
```

-   使用 `HttpClient` 設定 BaseAddress 時務必結尾要加 "/"

```csharp
❌ BAD: 設定 BaseAddress 時務必結尾沒加 "/"

httpClient.BaseAddress = new Uri("https://api.example.com");

✅ GOOD: 設定 BaseAddress 時務必結尾要加 "/"
httpClient.BaseAddress = new Uri("https://api.example.com/");
```

-   使用 `JsonHelper` 進行 JSON 序列化與反序列化

```csharp
❌ BAD: 使用 JsonSerializer 進行 JSON 序列化與反序列化
var json = JsonSerializer.Serialize(obj);
var result = JsonSerializer.Deserialize<T>(json);

✅ GOOD: 使用 JsonHelper 進行 JSON 序列化與反序列化
var json = JsonHelper.ToJson(obj);
var result = JsonHelper.FromJson<T>(json);
```

## Comments

-   避免不必要的註解：程式碼應具有自明性
-   解釋「為什麼」而非「如何做」：註解應描述背後的邏輯或意圖，而非程式碼的執行內容

## 使用 MCP 情境

-   如有套件相關不清楚的使用 `Context7` MCP 進行查詢最佳使用做法
-   如針對 C# 或者 .Net Core 框架尋找最佳實踐請使用 `microsoft-learn` MCP 進行查詢
